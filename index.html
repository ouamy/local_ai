<!DOCTYPE html>
<html>
<head>
    <title>Local AI</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <div id="container">
        <div id="output"></div>
        <textarea id="input" placeholder="Message AI" onkeypress="handleKeyPress(event)"></textarea>
        <button onclick="sendMessage()">Send</button>
    </div>
    <script>
        function sendMessage() {
            var inputText = document.getElementById('input').value;

            scrollToBottom();

            fetch('http://localhost:8000/sendMessage', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ inputText }),
            })
            .then(response => response.json())
            .then(data => {
                var loadingMessage = document.getElementById('loading-message');
                if (loadingMessage) {
                    loadingMessage.remove();
                }
                document.getElementById('output').innerHTML += "<div class='message bot-message'><strong>AI:</strong> " + data.output + "</div>";
                scrollToBottom();
            })
            .catch(error => {
                console.error('Error:', error);
            });

            document.getElementById('output').innerHTML += "<div class='message user-message'><strong>You:</strong> " + inputText + "</div>";
            document.getElementById('output').innerHTML += "<div id='loading-message' class='message bot-message loading-dots'><strong>AI:</strong></div>";
            document.getElementById('input').value = '';

            scrollToBottom();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function scrollToBottom() {
            var outputDiv = document.getElementById("output");
            outputDiv.scrollTop = outputDiv.scrollHeight;
        }
    </script>
</body>
</html>
